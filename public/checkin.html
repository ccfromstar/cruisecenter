<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<title>港区通关系统</title>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="renderer" content="webkit">
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<script src="../src/framework/jquery-1.9.1.js"></script>
		<script src="../src/framework/amazeui/amazeui.min.js"></script>
		<script type="text/javascript" src="../js/login.js"></script>
		<link rel="stylesheet" href="../src/framework/amazeui/amazeui.min.css" />
		<link rel="stylesheet" href="../css/basic.css" />
		<style>
			.header {
				text-align: center;
			}
			
			.header h1 {
				font-size: 200%;
				color: #333;
				margin-top: 30px;
			}
			
			.header p {
				font-size: 14px;
			}

			.passNo {
				font-weight: bold;
				font-size: 24px;
			}
		</style>
	</head>

	<body>
		<div class="header">
			<div class="am-g">
				<img style="width:300px;margin-top:50px;" src="/src/image/logo3.png">
				<h1><span class="passNo" id="hname">&nbsp;</span></h1>
				<h1>护照号：<span class="passNo" id="hpp"></span></h1>
				<h1>您是2017年08月22日登乘</h1>
				<h1>歌诗达</h1>
				<h1>赛琳娜号的</h1>
				<h1><span class="passNo" id="num">0</span>/2411</h1>
				<h1>乘客</h1>
				<h1>欢迎您</h1>
				<hr/>
				扫描区：<input type="text" name="code" id="code">
				<br/>
				<h1 id="info"></h1>
			</div>
		</div>
		<div class="am-alert am-alert-danger none errorinfo" data-am-alert></div>
	</body>
	<script type="text/javascript">
		var plist = '';
		var t1 = window.setInterval(function(){
			document.getElementById("code").focus();
			var code = $("#code").val();
			var num = Number($("#num").html());
			if(code!=""){
				$("#code").val("");
				var shipNo = code.substring(0,2);
				var passPort = code.replace(shipNo,'');
				var len = passPort.length;
				var HidePassPort = passPort.substr(0,3)+ "***" + passPort.substr(len-3);
				$.ajax({
					type: "post",
					url: "user/getInfo",
					data: {
						shipNo: shipNo,
						passPort: passPort
					},
					success: function(data) {
						if(plist.indexOf(passPort) != -1){
							$("#info").html('该条码已经扫描过');return false;
						}
						if(data.result == 'error'){
							$("#info").html('无此人信息');return false;
						}
						$("#info").html('');
						plist = plist + ";" + passPort;
						var name = data.name;
						var len = name.length;
						name = "**" + name.substr(len-1);
						$("#hname").html(name);
						$("#hpp").html(HidePassPort);
						num+=1;
						$("#num").html(num);
						$("#code").val("");
					}
				});
			}
		},100); 
	</script>
</html>